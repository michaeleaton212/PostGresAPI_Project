<div class="page">
  <h2 i18n>Booking</h2>
  <button class="back-button" (click)="goBackPreview(currentRoomId)" i18n>‚Üê Back</button>

  <!-- Loading state -->
  <div *ngIf="loading">
    <p i18n>Loading booking information...</p>
  </div>

  <!-- Error state -->
  <div *ngIf="error && !loading">
    <p style="color: red;">{{ error }}</p>
    <button (click)="goBack()" i18n>Back to Rooms</button>
  </div>

  <!-- Booking overview + Input + Buttons / Booking number -->
  <div *ngIf="room && !loading" class="overview">
    <br />
    <br />

    <h3 i18n>Overview</h3>
    <br />
    <div class="overview-row">
      <strong i18n>Room:</strong>
      <span>{{ room.name }}</span>
    </div>

    <div class="overview-row">
      <strong i18n>Type:</strong>
      <span>{{ room.type }}</span>
    </div>

    <div *ngIf="startDate" class="overview-row">
      <strong i18n>Check-in:</strong>
      <span>{{ startDate | date:'dd.MM.yyyy' }}</span>
    </div>

    <div *ngIf="endDate" class="overview-row">
      <strong i18n>Check-out:</strong>
      <span>{{ endDate | date:'dd.MM.yyyy' }}</span>
    </div>

    <!-- Bedroom: only number of days -->
    <div *ngIf="room?.type === 'Bedroom'" class="overview-row">
      <strong i18n>Duration:</strong>
      <span i18n>{{ numberOfDays }} day(s)</span>
    </div>

    <!-- Meetingroom: number of days + times -->
    <div *ngIf="room?.type === 'Meetingroom'" class="overview-row">
      <strong i18n>Duration:</strong>
      <span i18n>
        {{ numberOfDays }} day(s), {{ startDate | date:'HH:mm' }} - {{ endDate | date:'HH:mm' }} ({{ durationInMinutes }} min)
      </span>
    </div>

    <!-- If not booked show form -->
    <div class="form-group" *ngIf="!bookingSuccess">
      <label for="email">
        <strong class="left" i18n>Enter email:</strong>
      </label>
      <input id="email"
             name="email"
             type="email"
             [(ngModel)]="firstName"
             placeholder="Enter your email"
             i18n-placeholder
             maxlength="100"
             required />
    </div>

    <!-- When booked show booking number -->
    <div class="overview-row" *ngIf="bookingSuccess">
      <strong i18n>Booking number:</strong>
      <div class="bookingnumber">
        <span>{{ bookingNumber }}</span>
      </div>
    </div>

    <!-- Show button only when not booked -->
    <div class="button-row" *ngIf="!bookingSuccess">
      <button class="confirmBooking"
              (click)="confirmBooking()"
              [disabled]="bookingInProgress || !isFormValid"
              i18n>
        { bookingInProgress, select,
        true {Booking...}
        false {Confirm booking}
        }
      </button>
    </div>

    <!-- Success + Important text in cards -->
    <div *ngIf="bookingSuccess" class="booking-status">
      <div class="status-card status-success">
        <div class="status-icon">
          <span class="status-dot"></span>
        </div>
        <div class="status-content">
          <h4 i18n>Your booking was successful.</h4>
          <p i18n>
            Thank you for your reservation. A confirmation has been created.
          </p>
        </div>
      </div>

      <div class="status-card status-important">
        <div class="status-icon">
          <span class="status-dot"></span>
        </div>
        <div class="status-content">
          <h4 i18n>Important</h4>
          <p i18n>
            Keep your booking number in a safe place. You may need it for any changes or questions.
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="footer-wrapper">
    <app-footer></app-footer>
  </div>
</div>
